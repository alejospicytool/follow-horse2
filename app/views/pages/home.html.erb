<!-- Content -->
<div class="home container" style="margin-bottom: 0 !important;">

  <div class="title mb-3">
    <h5 class="section-title">Bienvenido <%= @user.nombre.capitalize %></h5>
    <span class="section-subtitle">Recomendaciones para ti</span>
  </div>

  <div class="cards mb-4 row">
    <% if @horses != [] %>
      <% @horses.each do |horse| %>
        <div class="col-sm-6 col-lg-4 col-sm-12">
          <div class="card w-100 mb-3">

            <% if horse.photos.any? %>
              <div class="card-image w-100 h-100 d-flex align-items-end justify-content-center" style="background-image: url('<%= cl_image_path horse.photos.last.key %>'); background-size: cover;">
                <div class="nombre m-0 w-100"><span><%= horse.name %></span></div>
              </div>
            <% else %>
              <div class="card-image w-100 h-100 d-flex align-items-end justify-content-center" style="background-image: url('<%= image_path 'caballo-placeholder-solo.png' %>'); background-repeat: no-repeat; background-position: center; background-size: 300px;">
                <div class="nombre m-0 w-100"><span><%= horse.name %></span></div>
              </div>
            <% end %>

            <div class="card-content">
              <div class="p-2 d-flex">
                <div class="col-3"></div>
                <div class="col-5 d-flex justify-content-center link align-items-center">
                  <%= link_to horse_show_path(horse.id) do %>
                    <span>VER MAS</span>
                  <% end %>
                </div>
                <div class="col-4 d-flex justify-content-end align-items-center pr-0">
                  <div class="d-flex align-items-center justify-content-center">
                    <%= button_to favorite_horse_text(horse), favorite_horse_path(horse: horse), class: "horse_heart_home mx-2", remote: true %>
                    <div data-controller="share" data-share-url-value="<%= horse_show_path(horse)%>">
                      <%= button_to image_tag('share.png'), "", data: {action: "click->share#share" }, style: "border: none; background: none; padding-bottom: 0.188rem;" %>
                      <%= content_tag(:span, "", class:"result", data: {share_target: "result" }) %>
                    </div>
                  </div>
                </div>
              </div>
            </div>

          </div>
        </div>
      <% end %>
    <% else %>
      <div class="d-flex justify-content-center align-items-center" style="height: 30vh;">
        <span>No hay recomendaciones disponibles por el momento</span>
      </div>
    <% end %>
  </div>
</div>

<div class="container w-100 d-flex justify-content-center" style="margin-top: 0 !important; margin-bottom: 4.5rem!important; padding: 0 !important;">
  <div class="lower-menu px-0 w-100">
    <ul class="p-0">
      <li>
        <%= link_to horses_path do %>
          <div>
            <span>Caballos</span>
            <%= image_tag('arrow-link-right.png') %>
          </div>
        <% end %>
      </li>
      <li>
        <%= link_to potros_path do %>
          <div>
            <span>Potros</span>
            <%= image_tag('arrow-link-right.png') %>
          </div>
        <% end %>
      </li>
      <li>
        <%= link_to active_auctions_path do %>
          <div>
            <span>Remates</span>
            <%= image_tag('arrow-link-right.png') %>
          </div>
        <% end %>
      </li>
      <li class="link-bold d-flex justify-content-center">
        <%= link_to search_path do %>
          <span class="align-self-center">Ver todas</span>
        <% end %>
      </li>
    </ul>
  </div>
</div>

<!-- Modal confirmacion registro -->
<% if params[:registro] == "ok" %>
  <%= render 'modal-registro' %>
<% end %>

<script>
  buttons = document.querySelectorAll('.horse_heart_home')
    buttons.forEach(
    function(button) {
      if (button.innerText == "fav"){
        button.innerHTML = "<i class='fa-solid fa-heart'></i>"
      } else if (button.innerText == "nofav"){
        button.innerHTML = "<i class='fa-regular fa-heart'></i>"
      }
      button.addEventListener('click', function() {
        if (button.innerHTML == `<i class="fa-solid fa-heart"></i>`) {
          button.innerHTML = `<i class="fa-regular fa-heart"></i>`
        } else if (button.innerHTML == `<i class="fa-regular fa-heart"></i>`){
          button.innerHTML = `<i class="fa-solid fa-heart"></i>`
        }
      })
    }
  )
</script>

<style>
  .horse_heart{
    border: none;
    background: none;
    padding: 0;
    color:white;
    font-size: 1.3rem;
  }

  .horse_heart_index{
    border: none;
    background: none;
    padding: 0;
    padding-top: 2px;
    color: #F2DA84;
    font-size: 1.3rem;
  }

  .horse_heart_home{
    border: none;
    background: none;
    padding: 0;
    padding-top: 2px;
    color: #F2DA84;
    font-size: 1.3rem;
  }
</style>
